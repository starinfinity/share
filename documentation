This DAG (Directed Acyclic Graph) is used for processing and generating reports related to the Americhoice MDRateCell data. The DAG performs various tasks including file operations, data processing, running Unix scripts, and generating reports.

DAG Details:

DAG ID: dag_asp_mem_americhoice_mdratecell_prd
Owner: csp_elig
Start Date: October 30, 2021
Default Arguments:
depends_on_past: False
email: ['UHGITCSP_DL@DS.UHC.COM', 'CnS_Eligibility_Modernization@ds.uhc.com']
email_on_failure: True
email_on_retry: False
retries: 0
Tasks:

check_schedule: This task checks if the current date is the last Saturday of the month and returns the DAG schedule accordingly. It is scheduled to run daily.
get_ecg_file: This task connects to the NAS server and retrieves the ECG input file. After retrieval, the file is deleted from the NAS server.
pre_processing: This task performs preprocessing on the input file. It adds the MDCAID at the end of each line and skips empty lines.
check_dates: This task checks the dates and paid amount in the file and adds a sequence number at the end of each line.
put_data: This task connects to the Unix server and transfers the processed file to the specified location.
run_unix_script: This task runs a Unix script called "run.fsg_mbcb_mdprocode" on the Unix server.
get_error_report: This task retrieves the error report generated by the Unix script.
split_error_report: This task splits the error report using the 'MDCAID' keyword.
counter1: This task counts the errors in the input files and writes the counts to the output file.
counter2: This task counts the errors in the Unix report file and writes the counts to the output file.
output_report: This task creates a summary report based on the counts obtained from the previous two tasks.
Task Dependencies:

The tasks have a linear dependency, i.e., each task depends on the successful completion of the previous task.
The task 'run_unix_script' depends on the completion of 'put_data'.
The tasks '





